/*
!! VIENE
*/

import 'package:smartsoadsense_core_package/SmartRoadSense-Core-Package.dart';
import 'package:test/test.dart';

import 'SmartRoadSenseTest.dart';

void main() {
  List<double> input = new List<double>.unmodifiable([
    0.21125266270064946,
    5.787372485489311,
    7.583749157768515,
    2.3306719586467564,
    1.9296518806986807,
    3.645156858487911,
    7.1144595299562665,
    4.164159196409037,
    2.001763261815901,
    5.268534749849161,
    5.634159760301882,
    5.211077824934759,
    9.059817650058163,
    9.396326530561213,
    1.4637054813380235,
    7.273420182258269,
    2.2684203228376063,
    7.897893495457207,
    3.1402495719987256,
    7.629922747506538,
    5.826649354636684,
    8.24477295960586,
    5.698045531782289,
    1.7504915303674617,
    2.2873426385807525,
    3.783949190816176,
    8.313586545608004,
    1.9661044467077993,
    7.221952331015294,
    9.949056326847357,
    6.5319378400446295,
    5.020521415335493,
    3.9019256140011205,
    4.516501550976813,
    4.214949318676178,
    8.432084221131774,
    6.872650842367831,
    6.5467128456611725,
    1.3383630307225414,
    4.158346657223049,
    7.563584779323495,
    1.7464080764234935,
    3.8136553256139716,
    8.183218880791056,
    3.408252409816063,
    1.6459895708216232,
    0.6217879019119854,
    6.335776291493056,
    4.340394843587756,
    0.20687376307438443,
    1.7198619769517909,
    9.90182235136875,
    6.9876126655667345,
    4.256763509225716,
    7.41800752134933,
    9.403760552750668,
    7.4014344096657485,
    3.496578327936015,
    6.222655282980854,
    1.3012725421219995,
    7.742815784893089,
    1.7309575047343473,
    3.5036821930248196,
    0.3047628206332553,
    0.9846545556817876,
    3.4449583590642927,
    7.766735418846809,
    9.495474636915425,
    0.3979824620324224,
    8.88276734417712,
    4.7983770218214055,
    1.5106425767105547,
    7.356077753105204,
    6.379956322307276,
    2.5005153219264376,
    6.678992899184627,
    1.8208141540687561,
    2.8590083103322463,
    0.8419197386011923,
    8.181363716995769,
    4.768143612814219,
    2.11854586136052,
    2.0284408499787543,
    0.0631634169060391,
    0.7646917418540711,
    5.829898832677424,
    5.729888909135919,
    1.2398415588399947,
    1.9250123252421392,
    4.000348378348323,
    3.0003491124417234,
    7.51350218805324,
    1.5591385986358786,
    0.07058923820576712,
    0.3900439424727531,
    4.058238043933374,
    6.962638337097431,
    0.7846547273042503,
    2.67067447194139,
    2.8337185139244125,
    6.006458243323358,
    2.503751986503967,
    8.582509841695689,
    2.951022275981461,
    1.451427589460258,
    3.7311602277359492,
    9.060314283530479,
    7.141648026315255,
    0.2423621569952561,
    8.273542061939,
    1.506530124330614,
    4.170104032135063,
    2.4292897421599644,
    4.6847295873624,
    6.853971393809669,
    5.2824159864743025,
    5.818400845308236,
    5.421242640551879,
    8.396598247651102,
    2.597356269154912,
    7.972898783741873,
    3.484502399900257,
    2.6657806245712,
    8.724146299402037,
    6.7640079884617945,
    5.232908951335709,
    2.9907832758129804,
    9.82983672208108,
    4.314974122480159,
    5.517651113121631,
    5.806033208379975,
    8.88152546582042,
    6.885969792802962,
    5.329320159584291,
    8.254058410441214,
    1.853023647812978,
    5.015394142134832,
    2.7381062308792945,
    3.181815117911123,
    7.312536393833612,
    4.063137059824925,
    5.068553607598876,
    4.239449090172606,
    8.997375289829224,
    5.193955882531535,
    3.9705586326649103,
    9.464366029395997,
    1.7336733042632613,
    0.7941857536492636,
    5.331494593200578
  ]);

  List<double> detrended = new List<double>.unmodifiable([
    -4.493909068607627,
    1.0822107541810349,
    2.8785874264602382,
    -2.37448977266152,
    -2.7755098506095957,
    -1.0600048728203655,
    2.40929779864799,
    -0.5410025348992393,
    -2.7033984694923756,
    0.5633730185408847,
    0.9289980289936057,
    0.5059160936264826,
    4.354655918749886,
    4.691164799252936,
    -3.241456249970253,
    2.568258450949992,
    -2.4367414084706702,
    3.19273176414893,
    -1.564912159309551,
    2.9247610161982616,
    1.1214876233284077,
    3.5396112282975842,
    0.9928838004740124,
    -2.954670200940815,
    -2.417819092727524,
    -0.9212125404921006,
    3.6084248142997275,
    -2.7390572846004773,
    2.5167905997070177,
    5.24389459553908,
    1.826776108736353,
    0.31535968402721615,
    -0.803236117307156,
    -0.18866018033146315,
    -0.4902124126320988,
    3.7269224898234974,
    2.167489111059554,
    1.841551114352896,
    -3.3667987005857354,
    -0.5468150740852273,
    2.8584230480152186,
    -2.958753654884783,
    -0.891506405694305,
    3.4780571494827797,
    -1.2969093214922136,
    -3.0591721604866535,
    -4.083373829396291,
    1.63061456018478,
    -0.36476688772052057,
    -4.4982879682338925,
    -2.9852997543564856,
    5.196660620060474,
    2.282450934258458,
    -0.4483982220825604,
    2.7128457900410536,
    4.698598821442392,
    2.696272678357472,
    -1.2085834033722613,
    1.5174935516725778,
    -3.403889189186277,
    3.037654053584813,
    -2.9742042265739292,
    -1.2014795382834569,
    -4.400398910675021,
    -3.720507175626489,
    -1.2602033722439838,
    3.061573687538533,
    4.7903129056071485,
    -4.307179269275855,
    4.1776056128688435,
    0.09321529051312893,
    -3.194519154597722,
    2.6509160217969274,
    1.6747945909989994,
    -2.204646409381839,
    1.9738311678763507,
    -2.88434757723952,
    -1.8461534209760302,
    -3.863241992707084,
    3.476201985687492,
    0.06298188150594264,
    -2.5866158699477566,
    -2.6767208813295222,
    -4.641998314402238,
    -3.9404699894542055,
    1.1247371013691474,
    1.0247271778276428,
    -3.4653201724682816,
    -2.7801494060661374,
    -0.7048133529599534,
    -1.704812618866553,
    2.808340456744964,
    -3.146023132672398,
    -4.634572493102509,
    -4.315117788835524,
    -0.6469236873749029,
    2.2574766057891544,
    -3.920507004004026,
    -2.0344872593668866,
    -1.871443217383864,
    1.3012965120150817,
    -2.2014097448043097,
    3.8773481103874126,
    -1.7541394553268157,
    -3.2537341418480183,
    -0.9740015035723273,
    4.3551525522222025,
    2.4364862950069783,
    -4.462799574313021,
    3.568380330630724,
    -3.1986316069776626,
    -0.5350576991732137,
    -2.275871989148312,
    -0.020432143945876113,
    2.1488096625013924,
    0.577254255166026,
    1.1132391139999598,
    0.7160809092436029,
    3.6914365163428258,
    -2.1078054621533644,
    3.2677370524335965,
    -1.2206593314080196,
    -2.0393811067370766,
    4.01898456809376,
    2.058846257153518,
    0.5277472200274325,
    -1.714378455495296,
    5.124674990772803,
    -0.39018760882811776,
    0.8124893818133545,
    1.1008714770716983,
    4.176363734512144,
    2.1808080614946856,
    0.6241584282760142,
    3.5488966791329375,
    -2.8521380834952987,
    0.31023241082655506,
    -1.967055500428982,
    -1.5233466133971536,
    2.607374662525335,
    -0.6420246714833517,
    0.3633918762905992,
    -0.4657126411356707,
    4.292213558520947,
    0.4887941512232583,
    -0.7346030986433663,
    4.75920429808772,
    -2.9714884270450153,
    -3.910975977659013,
    0.6263328618923012
  ]);

  List<double> aFinal = new List<double>.unmodifiable([
    -0.3595127254886102,
    0.08701941051687916,
    0.23499348271955184,
    -0.198687861683722,
    -0.24016035643572384,
    -0.09559864050465879,
    0.22802881081065,
    -0.054043731417638345,
    -0.28636612294257324,
    0.0635105233839303,
    0.11175542926230732,
    0.06506437825189354,
    0.599413225424215,
    0.6915055628526849,
    -0.5116998031452775,
    0.43402453030347315,
    -0.4405381505126565,
    0.6169083583311948,
    -0.3227978096431554,
    0.6431986446733999,
    0.26257033259851836,
    0.8809474115394806,
    0.2622760568633279,
    -0.8270700772294252,
    -0.716026860641792,
    -0.2881603326576005,
    1.190308034870336,
    -0.9512922010949594,
    0.918845781519871,
    2.009340707451099,
    0.7335362216645027,
    0.1325023838208641,
    -0.3526139466695567,
    -0.08640639293878664,
    -0.23390704231003212,
    1.8501207615343795,
    1.1179129301868138,
    0.98550727862069,
    -1.8670443810673334,
    -0.3138255186753403,
    1.6956861319742653,
    -1.8120555000541294,
    -0.5630080825845108,
    2.2622931025326425,
    -0.8678578900243649,
    -2.103703376559936,
    -2.8824745603310395,
    1.180311375356556,
    -0.2704589578120147,
    -3.4129018935263034,
    -2.315329061058912,
    4.11587652065948,
    1.844270240056159,
    -0.36927559146715216,
    2.2748885331683635,
    4.008133618383007,
    2.3376121355607733,
    -1.0639500504126,
    1.3552312715631694,
    -3.081161037034932,
    2.7844818295475946,
    -2.7584334595852575,
    -1.1264603429511,
    -4.167012847666976,
    -3.555467301591735,
    -1.2143060920057382,
    2.972069597495116,
    4.681023418478405,
    -4.233216367048778,
    4.126151486949569,
    0.09244558673745856,
    -3.1785431522834777,
    2.644146020376185,
    1.6732539044272206,
    -2.2044209969310624,
    1.9736293549601949,
    -2.881694191800805,
    -1.8414386502401225,
    -3.8439216630959296,
    3.447498049040965,
    0.06220615541737723,
    -2.542198490329351,
    -2.6156523336016946,
    -4.506291035232457,
    -3.7969559667498123,
    1.0748443150446805,
    0.970378232074029,
    -3.2489490045672746,
    -2.5784568106719727,
    -0.6460709283940553,
    -1.543176620844354,
    2.5080507287703853,
    -2.7695328773061214,
    -4.018077618771251,
    -3.6810056218855385,
    -0.5424854164754757,
    1.8591309415864692,
    -3.167855345712154,
    -1.611361401990414,
    -1.4514478356845875,
    0.9873083629279382,
    -1.6322506382574047,
    2.8065970908470907,
    -1.238256051614074,
    -2.237497970544141,
    -0.6517764008344464,
    2.832797494668799,
    1.538700640212439,
    -2.7331915588586067,
    2.1168500738411504,
    -1.8357435094312096,
    -0.29671404786225225,
    -1.2179343777284943,
    -0.010538165009450668,
    1.06671318763267,
    0.2754394462632676,
    0.5098636932823141,
    0.3143535382716808,
    1.5510040214797982,
    -0.8463826778319913,
    1.2521222463713717,
    -0.4456460054593703,
    -0.7082901671340422,
    1.3257390328500627,
    0.644018395619421,
    0.15629009891819098,
    -0.4798881178466113,
    1.3537128399560205,
    -0.09711088078371613,
    0.1902255564643226,
    0.24209808531040744,
    0.861467564012301,
    0.4213816945598456,
    0.11284151804691246,
    0.5997481342605815,
    -0.4502416146696678,
    0.04573010052810888,
    -0.2707628579846704,
    -0.1959131198067606,
    0.31365865756878614,
    -0.0723771312600489,
    0.038493445896529734,
    -0.04652260806878255,
    0.40623801426462003,
    0.04408286937327212,
    -0.06356401220130045,
    0.39823129001862473,
    -0.24257745584292273,
    -0.3144773999026728,
    0.050106628951384104
  ]);

  test('Detrend', () {
    List<double> copy = new List<double>.from(input);

    MathematicalExtensions.detrendOne(copy);

/*
    for (int i = 0; i < 150; i++) {
      if (copy[i] != detrended[i]) print("Non coincidente in posizione $i");
    }
*/
    //expect(ListEquality().equals(copy, detrended), true);
    expect(CheckExtensions.assertError(copy, detrended), null);
  });

  test('Detrend And Multiply Hamming', () {
    List<double> copy = new List<double>.from(input);

    MathematicalExtensions.detrendOne(copy);

    MathematicalExtensions.multiply1(copy, HammingWindow.generate(150));

    expect(CheckExtensions.assertError(copy, aFinal), null);
////////
    ///
    /*
    List<double> copy1 = new List<double>.from(input);
    MathematicalExtensions.detrendOne(copy1);

    MathematicalExtensions.multiply1(copy, HammingWindow.generate(150));
*/
//////

    //assert(ListEquality().equals(copy, aFinal));
    //print(copy);

    //expect(ListEquality().equals(copy, aFinal), true);

/*
    for (int i = 0; i < 150; i++) {
      if (copy[i] != aFinal[i]) print("Non coincidente in posizione $i");
    }
*/
    //expect(DeepCollectionEquality().equals(copy, aFinal), true);
    //expect(DeepCollectionEquality().equals(copy, copy1), true);
    
    //CheckExtensions.assertError(copy, aFinal);
  });
}
